{% include '_header.twig' %}

	<div style="">
		{% if record is defined %}
			{% set home = record %}

			<div style="margin-left: 30px;">
				{% if home.title is defined and home.title is not empty %}
				    <h1 style="color: white; text-align: left;">{{ home.title }}</h1>
				{% endif %}
				<div style="padding-left: 30px;">
					{% if home.teaser is defined and home.teaser is not empty %}
	    			    <h3 style="color: white; text-align: left;">{{ home.teaser }}</h3>
	    			{% endif %}
				</div>

				{% set blogname = "" %}
				{% if app.request.get('hostOrUrl') is not empty %}
					{% set blogname = app.request.get('hostOrUrl') %}
				{% endif %}

				<form>
					Tumblr blog name (or url):
					<input type="text" name="hostOrUrl" style="wdith: 40%;" {% if blogname != "" %}value={{blogname}}{% endif %} />
					<input type="submit" value="Update" />
				</form>
				<br />
				<br />

				{% set avatars = {} %}
				{% if blogname != "" %}
					{% set data = tumblr_GetPosts(blogname) %}
					{% if data is not empty %}
						{# TODO render posts #}
						<ol id="posts" class="posts">
						{% for post in data.posts %}
							{#{{ dump(post) }}#}
							{% set isReblog = post.reblogged_root_url is defined %}
							
							<li class="post_container">
								<div class="post post_full">
									<div class="post_avatar  show_user_menu post-avatar--fixed" style="left: 173px;">
										<div class="post_avatar_wrapper">
											<a class="post_avatar_link" href="http://{{post.blog_name}}.tumblr.com/" target="_blank" style="background-image: url(https://38.media.tumblr.com/avatar_132a74bdfd2c_64.png);">
												{% if avatars[blogname] is not defined %}
													{% set avatars = avatars|merge({blogname: tumblr_GetAvatar(blogname, 64)}) %}
												{% endif %}
												{{ avatars[blogname] }}
												<img class="post_avatar_image" src={{avatars[blogname]}} width="64" height="64">
											</a>
										</div>
									</div>
								</div>
							</li>

							<br />
						{% endfor %}
						</ol>
					
					{% else %}
						Something went wrong. Try checking the inputted tumblr URL.
					{% endif %}	
				{% endif %}

			</div>
		{% endif %}
	</div>

{% include '_footer.twig' %}
